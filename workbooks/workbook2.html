<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><title>Workbook 2</title><link rel="stylesheet" href="style.css" type="text/css"><meta name="generator" content="DocBook XSL Stylesheets V1.75.2"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><p class="docheader"><b>Java 1A Practical Class</b></p><div class="article" title="Workbook 2"><div class="titlepage"><div><div><h2 class="title"><a name="id2647513"></a>Workbook 2</h2></div></div><hr></div><div class="toc"><p><b>Table of Contents</b></p><dl><dt><span class="section"><a href="#sec:introduction">Introduction</a></span></dt><dt><span class="section"><a href="#sec:gameoflife">Conway's Game of Life</a></span></dt><dt><span class="section"><a href="#sec:outline">Outline</a></span></dt><dt><span class="section"><a href="#sec:initialise-world">Initialising the world</a></span></dt><dt><span class="section"><a href="#sec:conditionals">Retrieving and updating cells</a></span></dt><dd><dl><dt><span class="section"><a href="#if-statements">Conditional execution</a></span></dt></dl></dd><dt><span class="section"><a href="#sec:updating%20the%20world">Updating the world</a></span></dt><dd><dl><dt><span class="section"><a href="#sec:">Looping constructs</a></span></dt></dl></dd><dt><span class="section"><a href="#sec:main-loop">Displaying a Game of Life</a></span></dt><dt><span class="section"><a href="#sec:tick2">Java Tick 2</a></span></dt></dl></div><div class="section" title="Introduction"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="sec:introduction"></a>Introduction</h2></div></div></div><p>In this workbook you will use your implementation of <code class="code">PackedLong</code> from last week as a data structure in a simple implementation of Conway's Game of Life. Using this data structure imposes severe constraints on the size of game board which can be simulated. Next week you will overcome this limitation by making use of a Java array to store a game board of an arbitrary size.
</p><div class="important" title="Important" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Important</h3><p>Please replace <code class="code">your-crsid</code> with your own username in all examples and instructions.</p><p>Remember to check the course website regularly for announcements and errata:</p><p><a class="ulink" href="http://www.cl.cam.ac.uk/teaching/current/ProgJava" target="_top">http://www.cl.cam.ac.uk/teaching/current/ProgJava</a></p></div></div><div class="section" title="Conway's Game of Life"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="sec:gameoflife"></a>Conway's Game of Life</h2></div></div></div><p>John Conway was an undergraduate at Cambridge and read Mathematics. He stayed on at Cambridge to study for a Ph.D. and afterwards as a Lecturer. Conway invented the <em class="firstterm">Game of Life</em> in 1970. You can play the Game of Life with physical game pieces (a set of <em class="firstterm">stones</em> from Go<sup>[<a name="id2932034" href="#ftn.id2932034" class="footnote">1</a>]</sup> are a good choice) but a computer simulation of the Game of Life allows for quicker experimentation.</p><p>The game board, or <em class="firstterm">world</em>, for the Game of Life is a two-dimensional grid of square cells. Each cell in the world is in one of two states, <em class="firstterm">dead</em> or <em class="firstterm">alive</em>. The world transitions through a set of discrete <em class="firstterm">generations</em>, starting from the initial state of the cells at time zero, which is determined by the human player. The rules of the game describe how to transition from generation t to generation t+1, and are as follows:

</p><div class="itemizedlist"><ul class="itemizedlist" type="disc" compact><li class="listitem"><p>a live cell with fewer than two neighbours dies (caused by underpopulation);</p></li><li class="listitem"><p>a live cell with two or three neighbours lives (representing a balanced population);</p></li><li class="listitem"><p>a live cell with with more than three neighbours dies (caused by overcrowding and starvation); and</p></li><li class="listitem"><p>a dead cell with exactly three live neighbours comes alive (colonisation).</p></li></ul></div><p>
</p><p>The game calls for these rules to be applied simultaneously to all cells in order to
produce the next generation i.e. a cell which dies due to underpopulation could also
play a role in colonisation of another cell.  We will implement this by applying the rules to each cell
in turn and writing the results into a new, blank, world rather than updating the current one. 
 An example showing the application of the rules is given in <a class="xref" href="#fig:generation-update" title="Figure 1. Applying the Game of Life rules">Figure 1, “Applying the Game of Life rules”</a>.</p><div class="figure"><a name="fig:generation-update"></a><div class="figure-contents"><div class="mediaobject"><img src="figures/rules.png" alt="Applying the Game of Life rules"></div></div><p class="title"><b>Figure 1. Applying the Game of Life rules</b></p></div><br class="figure-break"></div><div class="section" title="Outline"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="sec:outline"></a>Outline</h2></div></div></div><p>In this workbook you will build an implementation of Conway's Game of Life using the <code class="code">PackedLong</code> class you wrote last week. The <code class="code">PackedLong</code> class is capable of storing at most 64 <code class="code">boolean</code> values in a variable of type <code class="code">long</code>. We will use these <code class="code">boolean</code> values to represent the liveness of a cell; in other words, if the cell is alive then <code class="code">true</code> is stored, and if the cell is dead then <code class="code">false</code> is recorded. The limit of 64 <code class="code">boolean</code> values restricts the size of the game board to an eight-by-eight world. Given this size restriction, this particular implementation of Conway's Game of Life is called <em class="firstterm">TinyLife</em> in this workbook.</p><p>You may recall that, given a variable <code class="code">v</code> of type <code class="code">long</code>, the <code class="code">set</code> method of <code class="code">PackedLong</code> class is able to set bit <code class="code">i</code> of <code class="code">v</code> to the value <code class="code">val</code> with the method call:
</p><pre class="programlisting">v = PackedLong.set(v,i,val)
</pre><p>
Note in particular the use of the assignment operator to update the value stored in the variable <code class="code">v</code>. Similarly, the state of bit <code class="code">i</code> of the variable <code class="code">v</code> of type <code class="code">long</code> can be retrieved and stored in variable <code class="code">b</code> of type <code class="code">boolean</code> using the method call:
</p><pre class="programlisting">b = PackedLong.get(v,i)
</pre><p>
</p><p>To use <code class="code">PackedLong</code> to store the state of the world, a mapping from cell location on the game board to the bit location in the variable is required. In order to maintain compatibility with the examples and test cases in this workbook you must use the mapping described here, although in principle there are 64 factorial possible valid mappings to choose from (most of which would be more tedious to implement than the one used here).</p><p>In this workbook you should use the bits stored by the <code class="code">PackedLong</code> class so that the state of top left cell of the board is stored in the least significant bit, the bottom right cell of the board is stored in the most significant bit, with the cells in between stored, in increasing bit positions, in row order. <a class="xref" href="#fig:bit-positions" title="Figure 2. Bit positions in PackedLong used to store the state of cells in TinyLife">Figure 2, “Bit positions in <code class="code">PackedLong</code> used to store the state of cells in TinyLife”</a> contains a graphical illustration of this specification.</p><div class="figure"><a name="fig:bit-positions"></a><div class="figure-contents"><div class="mediaobject"><img src="figures/bit-positions.png" alt="Bit positions of cells in TinyLife"></div></div><p class="title"><b>Figure 2. Bit positions in <code class="code">PackedLong</code> used to store the state of cells in TinyLife</b></p></div><br class="figure-break"><p>We will refer to an individual cell in the Game of Life by its column, c, and row, r, in the grid, written as a pair: (c,r). The cell (0,0) is at the very top left of the world, and the cell (7,7) is at the bottom right of the world. For example, in <a class="xref" href="#fig:bit-positions" title="Figure 2. Bit positions in PackedLong used to store the state of cells in TinyLife">Figure 2, “Bit positions in <code class="code">PackedLong</code> used to store the state of cells in TinyLife”</a>, the state of cell (0,0) is recorded at bit position 0, and the state of cell (3,2) is recorded at bit 19.</p><div class="sidebar" title="Converting cell row and column index to a PackedLong index."><p class="title"><b>Converting cell row and column index to a <code class="code">PackedLong</code> index.</b></p><p>Write answers to all of the questions found in this workbook into a plain text file called <code class="filename">answers.txt</code>. You will need to include your <code class="filename">answers.txt</code> file in your submission for your second Java Tick. Further information about the submission of the tick can be found at the end of this workbook.</p><p>A Java programmer has used the variables <code class="code">col</code> and <code class="code">row</code> to record the location of the cell (<code class="code">col</code>,<code class="code">row</code>).</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p>Write a Java expression which uses the variables <code class="code">col</code> and <code class="code">row</code> to determine the bit position used to store the state of cell (<code class="code">col</code>,<code class="code">row</code>). For example, if <code class="code">col</code> equals <code class="code">1</code> and <code class="code">row</code> equals <code class="code">2</code>, then your expression should return <code class="code">17</code>.
 </p></li><li class="listitem"><p>If the state of a cell is stored at bit position <code class="code">i</code>, write a Java expression to determine the value of <code class="code">col</code>, the column in the game board which contains the cell. For example, given the value <code class="code">17</code> your expression should return the value <code class="code">1</code>.
 </p></li><li class="listitem"><p>If the state of a cell is stored at bit position <code class="code">i</code>, write a Java expression to determine the value of <code class="code">row</code>, the row in the game board which contains the cell. For example, given the value <code class="code">17</code> your expression should return the value <code class="code">2</code>.
 </p></li></ol></div></div></div><div class="section" title="Initialising the world"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="sec:initialise-world"></a>Initialising the world</h2></div></div></div><p>Initialising the world in TinyLife is easy: simply define a new variable of type <code class="code">long</code> which contains the bit pattern representing the state of each of the 64 cells in the world. For example, the definitions of the variables <code class="code">oscillator</code> and <code class="code">glider</code> below contain the correct bit patterns to represent the worlds shown in  <a class="xref" href="#fig:tinylife-examples" title="Figure 3. Example TinyLife worlds">Figure 3, “Example TinyLife worlds”</a>. The printed workbook depicts the state of these worlds at generation zero; the on-line version of this workbook contains animated graphics which depict how the state of the world evolves over time. (These graphics are animated GIF files; you will learn how to build your own such animated graphics in Tick 3*.)

</p><pre class="programlisting">
long oscillator = 0x20272000027202L;
long glider = 0x20A0600000000000L;
</pre><p>
</p><div class="figure"><a name="fig:tinylife-examples"></a><div class="figure-contents"><span class="inlinemediaobject"><img src="figures/oscillator-period2-0x20272000027202.gif" alt="Example TinyLife worlds"></span>    
 <span class="inlinemediaobject"><img src="figures/glider-0x20A0600000000000.gif" alt="Example TinyLife worlds"></span><p>Left, a <em class="firstterm">two phase oscillator</em> (code: <code class="code">0x20272000027202L</code>) and right, a <em class="firstterm">glider</em> (code: <code class="code">0x20A0600000000000L</code>).</p></div><p class="title"><b>Figure 3. Example TinyLife worlds</b></p></div><br class="figure-break"><div class="sidebar"><p class="title"><b></b></p><p>A student defines a world as follows:

</p><pre class="programlisting">long world = 0x2623321111233262L;
</pre><p>
</p><div class="orderedlist"><ol class="orderedlist" start="4" type="1"><li class="listitem"><p>What is the value of the bit found in position 6 in the variable <code class="code">world</code>?</p></li><li class="listitem"><p>What is the value of cell (4,2) in the variable <code class="code">world</code>?</p></li></ol></div></div></div><div class="section" title="Retrieving and updating cells"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="sec:conditionals"></a>Retrieving and updating cells</h2></div></div></div><p>As you proceed through this workbook, you will fill in key parts of a program which will draw the state of TinyLife as textual characters to your terminal. The program that you will create will form your submission for Tick 2. Open a text editor and create a new class called <code class="code">TinyLife</code> inside the package <code class="code">uk.ac.cam.your-crsid.tick2</code>.

Add a special "main" method to the class <code class="code">TinyLife</code>. Check that your skeleton class works by inserting a Java statement to print out your name and compile and run your program.</p><p>Copy the file <code class="filename">PackedLong.java</code>, which you submitted as part of your work for last week, into the same directory as <code class="filename">TinyLife.java</code> . You will need a copy of <code class="filename">PackedLong.java</code> in the same directory as <code class="filename">TinyLife.java</code> so that your modifications to <code class="code">TinyLife</code> can make use of the features provided by <code class="code">PackedLong</code>. If you have not yet completed your implementation of <code class="code">PackedLong</code> you will need to complete this first before continuing with this workbook.
Remember to change the package of the PackedLong class to reflect its new location.  You should not
leave the PackedLong class in the tick1 package and call it from the tick2 package.  If you did this it would 
make your tick submission difficult because your 
tick submission will rely on the previous week's submission.
</p><p>In this section you will write two <em class="firstterm">methods</em> which will be used later in your implementation of TinyLife. A method is a unit of computation associated with a class in Java. A method provides a well-defined interface, specifying the values required to perform the computation described by the method, and the type of the result returned (if any). You saw two example methods last week when you wrote your implementation of <code class="code">PackedLong</code>; the methods were called <code class="code">set</code> and <code class="code">get</code>.</p><p>A method has a prototype which describes the types of the arguments which will be provided when the method is invoked, and the type of the result returned when the execution of the method finishes. The prototypes of the two methods you will write are in this section are:
</p><div class="itemizedlist"><ul class="itemizedlist" type="disc" compact><li class="listitem"><p><code class="code">public static boolean getCell(long world, int col, int row)</code></p></li><li class="listitem"><p><code class="code">public static long setCell(long world, int col, int row, boolean value)</code></p></li></ul></div><p>
</p><p>A method also has a <em class="firstterm">body</em>, which is a sequence of statements describing the computation the method should perform. The body of a Java method is encapsulated with opening and closing curly brackets (<code class="code">{</code> and <code class="code">}</code>). In Java the method prototype and body form a <em class="firstterm">method definition</em> and must be placed directly inside a Java class; you cannot place a method definition inside another method in Java.</p><div class="section" title="Conditional execution"><div class="titlepage"><div><div><h3 class="title"><a name="if-statements"></a>Conditional execution</h3></div></div></div><p>When writing the body of a method, it is a good idea to check the values provided to the method to make sure they are reasonable. This is sometimes called <em class="firstterm">input sanitisation</em>. For example, the method <code class="code">getCell</code> accepts three arguments. All possible values of type <code class="code">long</code> for the <code class="code">world</code> argument of <code class="code">getCell</code> are valid descriptions of a world in TinyLife, therefore no input sanitisation is required for this variable. The values of the second and third arguments, <code class="code">col</code> and <code class="code">row</code>, are only valid in the range from zero to seven; and input sanitisation must ensure that the method handles the case when the values of either <code class="code">col</code> or <code class="code">row</code> are outside this valid range. In the case of <code class="code">getCell</code>, an acceptable solution is to return the value <code class="code">false</code> from the method if <code class="code">col</code> or <code class="code">row</code> are greater than seven or smaller than zero. (This is equivalent to saying cells which are outside the 8-by-8 world are always dead.)</p><p>To do this input sanitisation we need to check the value of <code class="code">col</code> or <code class="code">row</code> and execute a different piece of Java program if the value of the variable is outside the valid range. In Java, conditional execution is performed with an <code class="code">if</code> statement. You saw an example <code class="code">if</code> statement in the body of the method <code class="code">PackedLong.set</code> in Tick 1. An <code class="code">if</code> statement is written as follows in Java:

</p><pre class="programlisting">if (boolean_expression)
 statement1
else
 statement2
</pre><p>
</p><p>You can replace <code class="code">statement1</code> or <code class="code">statement2</code> with a Java statement (e.g. "<code class="code">i = 2 * 6;</code>"). If you want to execute more than one Java statement conditionally, then you can use curly brackets to group together a set of Java statements into a <em class="firstterm">basic block</em> and use the basic block in place of <code class="code">statement1</code> or <code class="code">statement2</code>. The <code class="code">else</code> clause and <code class="code">statement2</code> can be removed if you only want to execute statements if <code class="code">boolean_expression</code> evaluates to <code class="code">true</code>. Here are some examples:
</p><pre class="programlisting">if (true)
 i=1;

if (i == 1) {
 System.out.println("true");
 i = 0;
} else {
 i = 1;
}
</pre><p>
</p><p>An alternative form of conditional execution operates <span class="emphasis"><em>within</em></span> a Java expression, and has the form:
</p><pre class="programlisting"> boolean_expression ? expression1 : expression2
</pre><p>

Here, if <code class="code">boolean_expression</code> evaluates to <code class="code">true</code> then <code class="code">expression1</code> is evaluated; otherwise <code class="code">expression2</code> is evaluated. A typical usage of this latter form of conditional execution is:
</p><pre class="programlisting">int i = boolean_expression ? one_var : another_var;
</pre><p> 
in which the value of <code class="code">i</code> is initialised with the current value stored in <code class="code">one_var</code> if <code class="code">boolean_expression</code> evaluates to <code class="code">true</code>, or with the current value stored in the variable <code class="code">another_var</code> if <code class="code">boolean_expression</code> evaluates to <code class="code">false</code>.
</p><p>Your next task is to use conditional execution to write an implementation of <code class="code">getCell</code>.  Your method's prototype should match the one given above. If either <code class="code">col</code> or <code class="code">row</code> are out of range it should return false, otherwise it should work out the corresponding bit-position, call the <code class="code">PackedLong.get</code> method and return the result.


</p><p>You should test your code by updating your copy of <code class="code">getCell</code> in <code class="filename">TinyLife.java</code> and placing a temporary piece of test code at the end of the <code class="code">main</code> method. The temporary code should invoke <code class="code">getCell</code> with the values of <code class="code">world</code>, <code class="code">col</code> and <code class="code">row</code> as shown in <a class="xref" href="#tab:getcell-test" title="Table 1. Test patterns for the getCell method">Table 1, “Test patterns for the <code class="code">getCell</code> method”</a> and print out the value returned by the method. You should check that the return values of your implementation of <code class="code">getCell</code> agrees with those found in the result column of the table. For example, to test the first pattern in the table you may like to use the following code:
</p><pre class="programlisting">
System.out.println(getCell(world,1,1));
</pre><p>
</p><div class="table"><a name="tab:getcell-test"></a><div class="table-contents"><table summary="Test patterns for the getCell method" border="1"><colgroup><col align="left"><col align="left"><col align="left"><col align="left"></colgroup><thead><tr><th align="left"><code class="code">world</code></th><th align="left"><code class="code">col</code></th><th align="left"><code class="code">row</code></th><th align="left">result</th></tr></thead><tbody><tr><td align="left"><code class="code">0x20A0600000000000L</code></td><td align="left"><code class="code">1</code></td><td align="left"><code class="code">1</code></td><td align="left"><code class="code">false</code></td></tr><tr><td align="left"><code class="code">0x20A0600000000000L</code></td><td align="left"><code class="code">-1</code></td><td align="left"><code class="code">1</code></td><td align="left"><code class="code">false</code></td></tr><tr><td align="left"><code class="code">0x20A0600000000000L</code></td><td align="left"><code class="code">3</code></td><td align="left"><code class="code">8</code></td><td align="left"><code class="code">false</code></td></tr><tr><td align="left"><code class="code">0x20A0600000000000L</code></td><td align="left"><code class="code">1</code></td><td align="left"><code class="code">-12</code></td><td align="left"><code class="code">false</code></td></tr><tr><td align="left"><code class="code">0x20A0600000000000L</code></td><td align="left"><code class="code">72</code></td><td align="left"><code class="code">2</code></td><td align="left"><code class="code">false</code></td></tr><tr><td align="left"><code class="code">0x20A0600000000000L</code></td><td align="left"><code class="code">5</code></td><td align="left"><code class="code">5</code></td><td align="left"><code class="code">true</code></td></tr><tr><td align="left"><code class="code">0x20A0600000000000L</code></td><td align="left"><code class="code">5</code></td><td align="left"><code class="code">6</code></td><td align="left"><code class="code">true</code></td></tr><tr><td align="left"><code class="code">0x20A0600000000000L</code></td><td align="left"><code class="code">6</code></td><td align="left"><code class="code">6</code></td><td align="left"><code class="code">false</code></td></tr></tbody></table></div><p class="title"><b>Table 1. Test patterns for the <code class="code">getCell</code> method</b></p></div><br class="table-break"><p>Type in the following as a new method into your class <code class="code">TinyLife</code>:

</p><pre class="programlisting">public static void print(long world) { 
 System.out.println("-"); 
 for (int row = 0; row &lt; 8; row++) { 
  for (int col = 0; col &lt; 8; col++) {
   System.out.print(getCell(world, col, row) ? "#" : "_"); 
  }
  System.out.println(); 
 } 
}
</pre><p>

Do not worry about the use of <code class="code">for</code> statement at the moment; you will find out what the <code class="code">for</code> loop does in the next section. The <code class="code">print</code> method allows you to print out a textual "picture" of the state of the world to the terminal. You should test this function by using it to print out the two example worlds as shown in <a class="xref" href="#fig:tinylife-examples" title="Figure 3. Example TinyLife worlds">Figure 3, “Example TinyLife worlds”</a>. Try this now by calling the <code class="code">print</code> function from within the main method of <code class="code">TinyLife</code> and providing a suitable value for the parameter <code class="code">world</code>.
</p><p>In order to step forward in time, we need a way of updating the cells of the world. Add a method called <code class="code">setCell</code> to your class <code class="code">TinyLife</code> with the following prototype:
</p><pre class="programlisting">public static long setCell(long world, int col, int row, boolean value)
</pre><p>

The <code class="code">setCell</code> method should use the <code class="code">PackedLong.set</code> method to update the cell (<code class="code">col</code>,<code class="code">row</code>) stored in <code class="code">world</code> with the value <code class="code">value</code>. The method should return the updated version of <code class="code">world</code> at the end of the method body. Please ensure that your implementation of <code class="code">setCell</code> performs input sanitisation where necessary.</p><p>You should make use of the <code class="code">print</code> method to make sure that your <code class="code">setCell</code> method works correctly. (Hint: initialise a variable called <code class="code">world</code> with a well-known pattern, update the variable with a call to <code class="code">setCell</code>, such as "<code class="code">world = setCell(world, 1, 1, true)</code>", and print out the contents of <code class="code">world</code> to confirm the correct cell was updated.)</p></div></div><div class="section" title="Updating the world"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="sec:updating%20the%20world"></a>Updating the world</h2></div></div></div><p>In this section you will use the two methods you wrote in the previous section to apply the rules of the Game of Life to the world and explore different generations. There are three basic tasks to perform when applying the rules of the Game of Life to calculate generation t+1 from the state of the world in generation t. These are: (1) for each cell, count the number of neighbours; (2) for each cell, given the number of neighbours, compute whether the cell lives or dies; and (3) generate a new data structure to represent the next generation. We can capture these three phases into three methods:

</p><div class="itemizedlist"><ul class="itemizedlist" type="disc" compact><li class="listitem"><p><code class="code">public static int countNeighbours(long world, int col, int row)</code></p></li><li class="listitem"><p><code class="code">public static boolean computeCell(long world,int col, int row)</code></p></li><li class="listitem"><p><code class="code">public static long nextGeneration(long world)</code></p></li></ul></div><p>
</p><p>You will complete implementations of these three methods in this section. Notice that these methods work together to provide a solution to calculating the state of the next generation: <code class="code">computeCell</code> should use <code class="code">countNeighbours</code>, and <code class="code">nextGeneration</code> should use <code class="code">computeCell</code>. Your first task in this section is to complete the method body for the function <code class="code">countNeighbours</code>. The method receives a description of the game board as the variable <code class="code">world</code> together with a specific indexed cell (<code class="code">col</code>,<code class="code">row</code>). Your implementation should count the number of neighbours which are alive in the eight locations immediately adjacent to the cell (<code class="code">col</code>,<code class="code">row</code>). For example, if your method is called as follows:
</p><pre class="programlisting">countNeighbours(0x20A0600000000000L,6,6);
</pre><p>

then your program should return the number of live cells which are adjacent to cell (6,6), which in this case is 5. (You can check that 5 is the correct answer by viewing world <code class="code">0x20A0600000000000L</code> in <a class="xref" href="#fig:tinylife-examples" title="Figure 3. Example TinyLife worlds">Figure 3, “Example TinyLife worlds”</a>.)
</p><div class="sidebar"><p class="title"><b></b></p><div class="orderedlist"><ol class="orderedlist" start="6" type="1"><li class="listitem"><p>Create a table similar to <a class="xref" href="#tab:getcell-test" title="Table 1. Test patterns for the getCell method">Table 1, “Test patterns for the <code class="code">getCell</code> method”</a> with five test cases for the method <code class="code">countNeighbours</code>. Your table will need four columns: <code class="code">world</code>, <code class="code">col</code>, <code class="code">row</code> and <span class="emphasis"><em>result</em></span>. You should use the world <code class="code">0x20A0600000000000L</code> in all your test cases and make sure you select cells which have 0, 1, 2 and 5 neighbours. You will probably find it helpful to refer to <a class="xref" href="#fig:tinylife-examples" title="Figure 3. Example TinyLife worlds">Figure 3, “Example TinyLife worlds”</a>.
</p></li><li class="listitem"><p>Use the table you have just created to test your implementation of <code class="code">countNeighbours</code>.</p></li></ol></div></div><p>Your next task in this section is to complete the implementation for <code class="code">computeCell</code> which should use your implementations of <code class="code">getCell</code> and <code class="code">countNeighbours</code> to compute the value that the specified cell should have in the next generation. A skeleton implementation of the method is shown below. You should complete the sections marked <code class="code">TODO</code>.</p><pre class="programlisting">
public static boolean computeCell(long world,int col,int row) {

 // liveCell is true if the cell at position (col,row) in world is live
 boolean liveCell = getCell(world, col, row);
	
 // neighbours is the number of live neighbours to cell (col,row)
 int neighbours = countNeighbours(world, col, row);

 // we will return this value at the end of the method to indicate whether 
 // cell (col,row) should be live in the next generation
 boolean nextCell = false;
	
 //A live cell with less than two neighbours dies (underpopulation)
 if (neighbours &lt; 2) {
  nextCell = false;
 }
 
 //A live cell with two or three neighbours lives (a balanced population)
 //TODO: write a if statement to check neighbours and update nextCell

 //A live cell with with more than three neighbours dies (overcrowding)
 //TODO: write a if statement to check neighbours and update nextCell

 //A dead cell with exactly three live neighbours comes alive
 //TODO: write a if statement to check neighbours and update nextCell
	
 return nextCell;
}
</pre><div class="sidebar"><p class="title"><b></b></p><div class="orderedlist"><ol class="orderedlist" start="8" type="1"><li class="listitem"><p>Create a table similar to <a class="xref" href="#tab:getcell-test" title="Table 1. Test patterns for the getCell method">Table 1, “Test patterns for the <code class="code">getCell</code> method”</a> which contains at least eight test cases for the method <code class="code">computeCell</code>. Your table will need four columns: <code class="code">world</code>, <code class="code">col</code>, <code class="code">row</code> and <span class="emphasis"><em>result</em></span>. You will probably find it helpful to refer to <a class="xref" href="#fig:tinylife-examples" title="Figure 3. Example TinyLife worlds">Figure 3, “Example TinyLife worlds”</a> when defining your test cases.
</p></li><li class="listitem"><p>Use the table you have just created to test your implementation of <code class="code">computeCell</code>.</p></li></ol></div></div><div class="section" title="Looping constructs"><div class="titlepage"><div><div><h3 class="title"><a name="sec:"></a>Looping constructs</h3></div></div></div><p>The <code class="code">print</code> method you saw earlier uses a new construct you haven't yet seen in Java: a <code class="code">for</code> loop. In general the <code class="code">for</code> loop has the following syntax:

</p><pre class="programlisting">for (initialisation; boolean_expression; step)
 statement 
</pre><p>
The <code class="code">initialisation</code> section is used to initialise a new or existing variable (if any). The <code class="code">boolean_expression</code> is evaluated to determine if the body of the <code class="code">for</code> loop should be executed (<code class="code">true</code> implies the body is executed and <code class="code">false</code> implies otherwise); <code class="code">boolean_expression</code> is re-evaluated every time the loop is executed. Finally, <code class="code">step</code> is an expression which is executed <span class="emphasis"><em>after</em></span> every iteration through <code class="code">statement</code>. As you've seen for the <code class="code">if</code> statement already, you can use curly brackets (<code class="code">{</code> and <code class="code">}</code>) to group together multiple Java statements together into a basic block, and use the basic block in place of <code class="code">statement</code>.</p><p>Another useful construct in Java for executing the same Java statement repeatedly is a <code class="code">while</code> loop. The <code class="code">while</code> loop has a simpler syntax than the <code class="code">for</code> loop:

</p><pre class="programlisting">while (boolean_expression)
 statement
</pre><p>

The <code class="code">while</code> loop will repeatedly execute <code class="code">statement</code> while <code class="code">boolean_expression</code> evaluates to <code class="code">true</code>; if <code class="code">boolean_expression</code> evaluates to false then execution continues with the next Java statement immediately following <code class="code">statement</code>. You can use a basic block to place multiple Java statements inside the body of the <code class="code">while</code> loop.
</p><p>Write an implementation of the <code class="code">nextGeneration</code> method. The method accepts a value of type <code class="code">long</code> which represents the state of the world at generation t; the method should return a value of type <code class="code">long</code> which represents the state of the world at generation t+1. The <code class="code">nextGeneration</code> method should make use of the <code class="code">computeCell</code> method to calculate the future state of a particular cell, and then use the <code class="code">setCell</code> method to update a local copy of the world held in a variable of type <code class="code">long</code>. You need to perform this action on <span class="emphasis"><em>all</em></span> 64 cells in TinyLife. Rather than writing code to update all 64 cells individually, you should use a pair of nested <code class="code">for</code> loops. (Hint: start off with a copy of the <code class="code">print</code> method as the body for <code class="code">nextGeneration</code> and rather than printing out the contents of each cell, use the <code class="code">for</code> loops to update each cell stored in a local variable representing the world at generation t+1.)</p></div></div><div class="section" title="Displaying a Game of Life"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="sec:main-loop"></a>Displaying a Game of Life</h2></div></div></div><p>Add the following method to <code class="code">TinyLife</code>:

</p><pre class="programlisting">public static void play(long world) throws Exception {
 int userResponse = 0;
 while (userResponse != 'q') {
  print(world);
  userResponse = System.in.read();
  world = nextGeneration(world);
 }
}
</pre><p>

and update your copy of the <code class="code">main</code> method to read:

</p><pre class="programlisting">public static void main(String[] args) throws Exception {
 play(Long.decode(args[0]));
}
</pre><p>
</p><p>If you have written your implementations of the five functions <code class="code">getCell</code>, <code class="code">countNeighbours</code>, <code class="code">computeCell</code>, <code class="code">setCell</code> and <code class="code">nextGeneration</code> correctly and included the provided methods <code class="code">print</code>, <code class="code">play</code> and <code class="code">main</code> you should now be able to invoke your Java program from the command line and supply a description of the initial state of the world as a <code class="code">long</code> literal value. For example:
</p><pre class="programlisting">crsid@machine:~&gt; java uk.ac.cam.your-crsid.tick2.TinyLife 0x20A0600000000000
</pre><p>
	should display a world containing a <span class="emphasis"><em>glider</em></span>. Pressing <span class="keycap"><strong>Enter</strong></span> will display
	 successive generations of the world, and typing <span class="keycap"><strong>q</strong></span> followed by <span class="keycap"><strong>Enter</strong></span> will terminate your program.
	 Note that when running your program from the command line you should not type the trailing <code class="code">L</code>
	 on the end of a <code class="code">long</code> literal.
</p><p><a class="xref" href="#fig:more-tinylife-examples" title="Figure 4. Example TinyLife worlds">Figure 4, “Example TinyLife worlds”</a> contains two further examples which you may wish to try. The on-line version of this work book has animated versions of these worlds which you may wish to view in order to confirm your program is operating correctly.</p><div class="figure"><a name="fig:more-tinylife-examples"></a><div class="figure-contents"><span class="inlinemediaobject"><img src="figures/oscillator-period5-0x1824428181422418.gif" alt="Example TinyLife worlds"></span>    
 <span class="inlinemediaobject"><img src="figures/still-life-0x205032050502303.gif" alt="Example TinyLife worlds"></span><p>Left, a <em class="firstterm">five phase oscillator</em> (code: <code class="code">0x1824428181422418L</code>) and right, a <em class="firstterm">still life</em> (code: <code class="code">0x205032050502303L</code>).</p></div><p class="title"><b>Figure 4. Example TinyLife worlds</b></p></div><br class="figure-break"></div><div class="section" title="Java Tick 2"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="sec:tick2"></a>Java Tick 2</h2></div></div></div><p>In the course of this Tick you should have written five methods: <code class="code">getCell</code>, <code class="code">countNeighbours</code>, <code class="code">computeCell</code>, <code class="code">setCell</code> and <code class="code">nextGeneration</code>, as well as including three provided methods <code class="code">print</code>, <code class="code">play</code> and <code class="code">main</code> into a class called <code class="code">TinyLife</code>. In addition you should also have produced an <code class="code">answers.txt</code> file and copied across your implementation of <code class="code">PackedLong</code> from last week.</p><p>To submit your tick for this week, produce a jar file called <code class="filename">crsid-tick2.jar</code> with the following contents:
</p><pre class="programlisting">
META-INF/
META-INF/MANIFEST.MF
uk/ac/cam/your-crsid/tick2/TinyLife.class
uk/ac/cam/your-crsid/tick2/TinyLife.java
uk/ac/cam/your-crsid/tick2/PackedLong.class
uk/ac/cam/your-crsid/tick2/PackedLong.java
uk/ac/cam/your-crsid/tick2/answers.txt		
</pre><p>
</p><p>The jar file should have it's entry point set to <code class="code">uk.ac.cam.your-crsid.tick2.TinyLife</code> so that you can invoke TinyLife from the command line as follows:
</p><pre class="programlisting">
crsid@machine:~&gt; java -jar crsid-tick2.jar 0x20A0600000000000
</pre><p>
</p><p>Once you have produced a suitable jar file and tested that it works as shown above, you can submit it by emailing it as an attachment to <code class="code">ticks1a-java@cl.cam.ac.uk</code>.</p></div><div class="footnotes"><br><hr width="100" align="left"><div class="footnote"><p><sup>[<a name="ftn.id2932034" href="#id2932034" class="para">1</a>] </sup><a class="ulink" href="http://en.wikipedia.org/wiki/Go_(board_game)" target="_top">http://en.wikipedia.org/wiki/Go_(board_game)</a></p></div></div></div><p class="docfooter">Copyright 2008-2012 Alastair R. Beresford and Andrew C. Rice</p></body></html>
